# ============================================
# DISTRIBUIDORA PAUCARA - WEBSOCKET SERVER
# ============================================

# Entorno de ejecución (development/production)
NODE_ENV=development

# Puerto del servidor WebSocket
PORT=3001

# Secret key para autenticación de backend (Laravel)
# IMPORTANTE: Cambiar este valor en producción
WS_SECRET=your-secret-key-here

# ============================================
# CONFIGURACIÓN DE CORS - DESARROLLO
# ============================================
CLIENT_URL=http://localhost:8000
MOBILE_CLIENT_URL=http://192.168.100.21:3000

# ============================================
# CONFIGURACIÓN DE CORS - PRODUCCIÓN
# ============================================
# Descomentar estas líneas en producción
# CLIENT_URL=https://tu-dominio.com
# MOBILE_CLIENT_URL=https://tu-dominio.com
# WEBSOCKET_URL=https://websocket.tu-dominio.com

# ============================================
# CONFIGURACIÓN DE SOCKET.IO
# ============================================
SOCKET_PING_TIMEOUT=60000
SOCKET_PING_INTERVAL=25000
SOCKET_MAX_HTTP_BUFFER_SIZE=1048576

# ============================================
# CONFIGURACIÓN DE LOGS
# ============================================
ENABLE_LOGS=true
LOG_LEVEL=info

# ============================================
# CONFIGURACIÓN DE HOST ESPECÍFICO
# ============================================

# Host específico para evitar conflictos con múltiples tarjetas de red
WEBSOCKET_HOST=0.0.0.0
# O usa una IP específica como: WEBSOCKET_HOST=192.168.1.100

# URL completa del websocket (para producción)
WEBSOCKET_URL=http://localhost:3001
# En producción sería algo como: WEBSOCKET_URL=https://websocket.tu-dominio.com

# IP específica para desarrollo (opcional)
PREFERRED_IP=192.168.1.100

# ============================================
# CONFIGURACIÓN DE BASE DE DATOS POSTGRESQL
# ============================================
# ⚠️ IMPORTANTE: Estas variables son NECESARIAS para validación de tokens Sanctum
#
# El WebSocket server valida tokens Sanctum cuando clientes (React/Flutter)
# se conectan directamente al WebSocket usando socket.emit('authenticate', {token})
#
# Debe apuntar a la MISMA base de datos que Laravel

DB_HOST=localhost
DB_PORT=5432
DB_DATABASE=distribuidora-paucara
DB_USERNAME=postgres
DB_PASSWORD=your-password-here
DB_SSL=false

# ============================================
# ARQUITECTURA DE AUTENTICACIÓN DUAL
# ============================================
#
# El WebSocket server tiene 2 flujos de autenticación:
#
# FLUJO 1: HTTP POST desde Laravel (Backend-to-Backend)
#   Laravel → HTTP POST → ensureBackend middleware (valida WS_SECRET)
#   Variables usadas: WS_SECRET
#   NO requiere validación de token Sanctum
#   Ejemplo: Notificaciones de proformas, envíos, etc.
#
# FLUJO 2: Conexión WebSocket Directa (Client-to-WebSocket)
#   React/Flutter → socket.emit('authenticate', {token}) → sanctum-auth.middleware
#   Variables usadas: DB_HOST, DB_PORT, DB_DATABASE, DB_USERNAME, DB_PASSWORD
#   SÍ requiere validación de token Sanctum contra PostgreSQL
#   Ejemplo: Cliente conectándose para recibir notificaciones en tiempo real
#
# ⚠️ Por lo tanto, las variables DB son NECESARIAS y NO pueden eliminarse
#

# ============================================
# PRODUCCIÓN
# ============================================
# Configuración para servidor de producción:
#
# NODE_ENV=production
# PORT=3001
# WS_SECRET=clave-super-secreta-cambiar-en-produccion
# CLIENT_URL=https://tu-dominio.com
# WEBSOCKET_URL=https://websocket.tu-dominio.com
# DB_HOST=your-production-db-host
# DB_DATABASE=your-production-db-name
# DB_USERNAME=your-production-db-user
# DB_PASSWORD=your-production-db-password
# DB_SSL=true

# ============================================
# CONFIGURACIÓN DE LARAVEL API - FASE 2
# ============================================
# URL de la API de Laravel para consultar estados centralizados
# ⚠️ IMPORTANTE: Esta URL DEBE apuntar a tu API (local o remota)
# Desarrollo: http://localhost:8000/api
# Producción: https://gestorlp.up.railway.app/api (o tu URL real)
LARAVEL_API_URL=http://localhost:8000/api
API_TIMEOUT=10000

# ============================================
# CONFIGURACIÓN DE CACHE DE ESTADOS - FASE 2
# ============================================
# TTL del cache en memoria (milisegundos)
# Por defecto: 3600000 (1 hora)
STATE_CACHE_TTL=3600000
